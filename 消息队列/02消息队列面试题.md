## 1 RabbitMQ、ActiveMQ、RocketMQ、Kafka比较

|    特性    |                           ActiveMQ                           |                           RabbitMQ                           |         RocketMQ         |                            Kafka                             |
| :--------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------: | :----------------------------------------------------------: |
|    语言    |                             java                             |                            erlang                            |           java           |                            scala                             |
| 单机吞吐量 |                             万级                             |                             万级                             |          十万级          |                            十万级                            |
|   时效性   |                             ms级                             |                             us级                             |           ms级           |                             ms级                             |
|   可用性   |                         高(主从架构)                         |                         高(主从架构)                         |    非常高(分布式架构)    |                      非常高(分布式架构)                      |
|  功能特性  | 成熟的产品，在很多公司得到应用；有较多的文档；各种协议支持较好 | 基于erlang开发，所以并发能力很强，性能极其好，延时很低;管理界面较丰富 | MQ功能比较完备，扩展性佳 | 只支持主要的MQ功能，像一些消息查询，消息回溯等功能没有提供，毕竟是为大数据准备的，在大数据领域应用广。 |

(1) 中小型软件公司，建议选RabbitMQ.一方面，erlang语言天生具备高并发的特性，而且他的管理界面用起来十分方便。正所谓，成也萧何，败也萧何！他的弊端也在这里，虽然RabbitMQ是开源的，然而国内有几个能定制化开发erlang的程序员呢？所幸，RabbitMQ的社区十分活跃，可以解决开发过程中遇到的bug，这点对于中小型公司来说十分重要。不考虑rocketmq和kafka的原因是，一方面中小型软件公司不如互联网公司，数据量没那么大，选消息中间件，应首选功能比较完备的，所以kafka排除。不考虑rocketmq的原因是，rocketmq是阿里出品，如果阿里放弃维护rocketmq，中小型公司一般抽不出人来进行rocketmq的定制化开发，因此不推荐。

(2) 大型软件公司，根据具体使用在rocketMq和kafka之间二选一。一方面，大型软件公司，具备足够的资金搭建分布式环境，也具备足够大的数据量。针对rocketMQ,大型软件公司也可以抽出人手对rocketMQ进行定制化开发，毕竟国内有能力改JAVA源码的人，还是相当多的。至于kafka，根据业务场景选择，如果有日志采集功能，肯定是首选kafka了。具体该选哪个，看使用场景。

## 2 消息中间件集群崩溃，如何保证百万生产数据不丢失？

## 3 如何保证消息队列的高可用？

## 4 如何保证消息不被重复消费？

## 5 如何保证消息的可靠性传输？

## 6 如何保证消息的顺序性？

## 7 主从架构和分布式架构的区别

## 8 消息队列的缺点

- 系统复杂性增加：引入消息队列后要考虑消息一致性、消息是否被重复消费，消息传递的可靠性等等
- 系统可用性下降：引入消息队列之后，一旦消息队列服务挂了系统就可能崩溃